@inherits FillInBlanksBase
@namespace RealJapanese.Components.Shared

<div class="fib-wrap">
    @if (!string.IsNullOrWhiteSpace(TopText))
    {
        <p class="lead mb-3">@TopText</p>
    }

    <div class="fib-line mb-3">
        @for (int i = 0; i < Chunks.Count; i++)
        {
            <span class="fib-chunk">@Chunks[i]</span>

            if (i < BlankCount)
            {
                var idx = i;
                <span class="fib-blank">
                    <input
                        @ref="inputRefs[idx]"
                        class="form-control form-control-lg d-inline-flex fib-input"
                        style="width:@InputWidth; text-align:center; display:inline-block;"
                        placeholder="@Placeholder"
                        @bind="UserAnswers[idx]"
                        @bind:event="oninput"
                        @onkeydown="e => OnKeyDown(idx, e)"
                        @onkeydown:preventDefault="ShouldPreventDefault(idx)"
                    />

                    @if (ShowResults && ShowAnswerBelow)
                    {
                        <div class="form-text mt-1">
                            @Answers[idx]
                        </div>
                    }
                </span>
            }
        }
    </div>

    <div class="d-flex gap-2">
        <button class="btn btn-outline-secondary" @onclick="Reveal" disabled="@ShowResults">Show answers</button>
        <button class="btn btn-primary" @onclick="Submit" disabled="@(!ReadyToSubmit)">Check</button>
    </div>
</div>